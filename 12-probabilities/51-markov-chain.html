
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Markov Chain &#8212; Data Science Handbook</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sampling" href="71-sampling.html" />
    <link rel="prev" title="Bayesian’s Theorem" href="31-bayesian-theorem.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Data Science Handbook</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Data Science Handbook
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Foundations
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../11-math/00-math.html">
   Math
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../11-math/11-combinatorics.html">
     Combinatorics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11-math/12-derangement.html">
     Derangement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11-math/20-vector-spaces.html">
     Vector Spaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11-math/21-linear-algebra.html">
     Linear Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11-math/51-linear-programming.html">
     Linear Programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11-math/90-puzzles.html">
     Puzzles
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="00-probabilities.html">
   Probabilities
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="11-expectation-and-variance.html">
     Expectation and Variance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="13-correlation-and-dependence.html">
     Correlation and Dependence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="31-bayesian-theorem.html">
     Bayesian’s Theorem
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Markov Chain
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="71-sampling.html">
     Sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="90-multivariate-notations.html">
     Multivariate Notations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="91-exponential-families.html">
     Exponential Families
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="91-large-sample-theory.html">
     Large Sample Theory
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../13-statistics/00-statistics.html">
   Statistics
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../13-statistics/11-sample-survey.html">
     Sample Survey
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13-statistics/13-randomized-trial.html">
     Causality and Randomized Trial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13-statistics/21-hypothesis-testing.html">
     Hypothesis Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13-statistics/25-two-sample-tests.html">
     Two Sample Mean Tests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13-statistics/33-confusion-matrix.html">
     Confusion Matrix
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13-statistics/41-maximum-likelihood-estimation.html">
     Maximum Likelihood Estimator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13-statistics/43-estimators-evaluation.html">
     Estimators Evaluation
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../14-python/00-python.html">
   Python
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../14-python/11-programming-tools.html">
     Programmer tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../14-python/12-syntax.html">
     Syntax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../14-python/13-data-structure.html">
     Data Structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../14-python/15-functional-programming.html">
     Functional Programming
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../17-sql/00-sql.html">
   SQL
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../17-sql/11-database.html">
     Database
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../17-sql/12-relational-structure.html">
     Relational Structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../17-sql/31-data-query.html">
     Data Query
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../17-sql/33-data-manipulation.html">
     Data Manipulation
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../19-miscellaneous/00-miscellaneous.html">
   Miscellaneous
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../19-miscellaneous/11-latex.html">
     LaTeX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../19-miscellaneous/13-myst.html">
     MyST Markdown
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Algorithms
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../20-algorithms-concepts/00-algorithms-concepts.html">
   Algorithms Concepts
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../20-algorithms-concepts/51-polynomial-reduction.html">
     Polynomial Reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20-algorithms-concepts/53-P-and-NP.html">
     <span class="math notranslate nohighlight">
      \(P\)
     </span>
     and
     <span class="math notranslate nohighlight">
      \(NP\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20-algorithms-concepts/61-randomized-algo.html">
     Randomized Algorithms
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../21-greedy-algorithms/00-greedy-algorithms.html">
   Greedy Algorithms
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../21-greedy-algorithms/11-interval-scheduling.html">
     Interval Scheduling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../21-greedy-algorithms/31-huffman-coding.html">
     Huffman Coding
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../23-dynamic-programming/00-dynamic-programming.html">
   Dynamic Programming
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../23-dynamic-programming/11-weighted-interval-scheduling.html">
     Weighted Interval Scheduling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../23-dynamic-programming/13-longest-common-subsequence.html">
     Longest Common Subsequence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../23-dynamic-programming/15-longest-increasing-subsequence.html">
     Longest Increasing Subsequence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../23-dynamic-programming/17-largest-sum-subsequence.html">
     Largest Sum Subsequence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../23-dynamic-programming/31-knapsack.html">
     Minimum Knapsack
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../23-dynamic-programming/51-chain-matrix-multiplication.html">
     Chain Matrix Multiplication
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../25-graph-related/00-graph-related.html">
   Graph Related
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../25-graph-related/13-shortest-path.html">
     Shortest Path
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25-graph-related/21-minimum-spanning-tree.html">
     Minimum Spanning Tree
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25-graph-related/31-maximum-flow.html">
     Maximum Flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25-graph-related/32-matching.html">
     Matching
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25-graph-related/42-maximum-independent-set.html">
     Maximum Independent Set in Trees
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25-graph-related/91-LP-max-flow-min-cut.html">
     LP on Max-flow and Min-cut
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../30-ml-basics/00-ml-basics.html">
   Machine Learning Basics
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../30-ml-basics/02-taxonomy.html">
     Taxonomy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../30-ml-basics/03-information-theory.html">
     Information Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../30-ml-basics/05-kernels.html">
     Kernels
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../30-ml-basics/11-data-issues.html">
     Data Issues
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../30-ml-basics/51-semi-supervised.html">
     Semi-supervised Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../30-ml-basics/53-self-supervised.html">
     Self-supervised Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../30-ml-basics/61-fourier-transform.html">
     Fourier Transform-based Representations
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../31-regression/00-regression.html">
   Regression
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../31-regression/11-lm-estimation.html">
     Linear Models - Estimation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31-regression/12-lm-inference.html">
     Linear Models - Inference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31-regression/13-lm-diagnosis.html">
     Linear Models - Diagnosis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31-regression/14-lm-advanced.html">
     Linear Models - Advanced Topics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31-regression/21-generalized-linear-models.html">
     Generalized Linear Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31-regression/22-logistic-regression.html">
     Logistic Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31-regression/23-multinomial-logitsitc.html">
     Multinomial Logistic Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31-regression/24-ordinal-logistic.html">
     Ordinal Logistic Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31-regression/25-poisson-regression.html">
     Poisson Regression
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../32-classification/00-classification.html">
   Classification
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../32-classification/11-support-vector-machine.html">
     Support Vector Machine
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32-classification/21-decision-tree.html">
     Decision Tree
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../33-dimensionality-reduction/00-dimensionality-reduction.html">
   Dimensionality Reduction
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../33-dimensionality-reduction/11-principal-component-analysis.html">
     Principal Component Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../33-dimensionality-reduction/13-canonical-correlation-analysis.html">
     Canonical Corerlation Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../33-dimensionality-reduction/21-multidimensional-scaling.html">
     Multidimensional Scaling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../33-dimensionality-reduction/23-graph-based-spectral-methods.html">
     Graph-based Spectral Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../33-dimensionality-reduction/25-t-SNE.html">
     SNE and
     <span class="math notranslate nohighlight">
      \(t\)
     </span>
     -SNE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../33-dimensionality-reduction/31-kernel-pca.html">
     Kernel PCA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../33-dimensionality-reduction/32-kernel-cca.html">
     Kernel CCA
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../34-clustering/00-clustering.html">
   Clustering
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../34-clustering/11-k-means.html">
     <span class="math notranslate nohighlight">
      \(k\)
     </span>
     -means clustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../34-clustering/13-agglomerative-methods.html">
     Agglomerative Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../34-clustering/31-spectral-clustering.html">
     Spectral Clustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../34-clustering/41-gaussian-mixtures.html">
     Gaussian Mixtures
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../35-graphical-models/00-graphical-models.html">
   Graphical Models
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../35-graphical-models/11-hidden-markov-models.html">
     Hidden Markov Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../35-graphical-models/31-topic-models.html">
     Topic Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../35-graphical-models/33-language-models.html">
     Language Models
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../37-neural-networks/00-neural-networks.html">
   Neural Networks
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../37-neural-networks/01-stochastic-gradient-descent.html">
     Stochastic Gradient Descent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../37-neural-networks/03-trainability.html">
     Trainability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../37-neural-networks/05-regularization.html">
     Regularization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../37-neural-networks/11-autoencoders.html">
     Autoencoders
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../37-neural-networks/13-variational-autoencoders.html">
     Variational Autoencoders
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../37-neural-networks/31-sequential-models.html">
     Sequential Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../37-neural-networks/41-GAN.html">
     Generative Adversarial Networks
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../38-ml-for-graph-data/00-ml-for-graph-data.html">
   For Graph-structured Data
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../38-ml-for-graph-data/01-graph-basics.html">
     Graph Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../38-ml-for-graph-data/11-descriptive-analysis.html">
     Descriptive Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../38-ml-for-graph-data/13-sampling-and-estimation.html">
     Sampling and Estimation
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/12-probabilities/51-markov-chain.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/12-probabilities/51-markov-chain.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/dennissxz/data-science-handbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/dennissxz/data-science-handbook/issues/new?title=Issue%20on%20page%20%2F12-probabilities/51-markov-chain.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/dennissxz/data-science-handbook/master?urlpath=tree/12-probabilities/51-markov-chain.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definitions">
   Definitions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basics">
     Basics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#irreducibility">
     Irreducibility
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#periodicity">
     Periodicity
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stationary-distribution">
   Stationary Distribution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise">
   Exercise
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#infect-1000">
     Infect 1000
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sol-1-markov-chain">
       Sol.1 Markov Chain
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sol-2-conditional-expectation">
       Sol.2 Conditional Expectation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sol-3-simulation">
       Sol.3 Simulation
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="markov-chain">
<h1>Markov Chain<a class="headerlink" href="#markov-chain" title="Permalink to this headline">¶</a></h1>
<div class="section" id="definitions">
<h2>Definitions<a class="headerlink" href="#definitions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="basics">
<h3>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">¶</a></h3>
<p>A <strong>stochastic process</strong> <span class="math notranslate nohighlight">\(\boldsymbol{X} = \left\{ X_t: t\in T \right\}\)</span> is a collection of random variables indexed by <span class="math notranslate nohighlight">\(t\)</span>. We call <span class="math notranslate nohighlight">\(X_t\)</span> the <strong>sate</strong> of the process at time <span class="math notranslate nohighlight">\(t\)</span>. If <span class="math notranslate nohighlight">\(T\)</span> is countable infinite, then we call <span class="math notranslate nohighlight">\(\boldsymbol{X}\)</span> a <strong>discrete</strong> time process.</p>
<p>A discrete time process <span class="math notranslate nohighlight">\(\boldsymbol{X} = \left\{ X_0, X_1, \ldots \right\}\)</span> is called a <strong>Markov chain</strong> if, for any positive integer <span class="math notranslate nohighlight">\(t\)</span> and any states <span class="math notranslate nohighlight">\(i_0, \ldots, i_t, j\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbb{P}\left(X_{t+1}=j \mid X_{t}=i, X_{t-1}=i_{t-1}, \ldots, X_{0}=i_{0}\right) =\mathbb{P}\left(X_{t+1}=j \mid X_{t}=i\right) \\
\end{split}\]</div>
<p>Verbally, we say that, given the past history of the process up through time <span class="math notranslate nohighlight">\(t\)</span>, the distribution of the process at time <span class="math notranslate nohighlight">\(t+1\)</span> depends only on the state at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>We say a Markov chain has a <strong>discrete state space</strong> if the set of values of the random variables is countably infinite <span class="math notranslate nohighlight">\(\left\{ v_0, v_1, \ldots \right\}\)</span>. For simplicity, we assume the discrete state space is given by the set of nonnegative integers <span class="math notranslate nohighlight">\(\left\{ 0,1,\ldots \right\}\)</span>. We say a Markov chain is <strong>finite</strong> if the set of values of the random variables if a finite set <span class="math notranslate nohighlight">\(\left\{ v_0, v_1, \ldots, v_{n-1} \right\}\)</span>. In the following discussion we assume the Markov chains are finite.</p>
<p>A Markov chain is <strong>homogeneous</strong> if <span class="math notranslate nohighlight">\(\mathbb{P}\left(X_{t+1}=j \mid X_{t}=i\right)=p_{i j}\)</span> for all <span class="math notranslate nohighlight">\(t\)</span>. This indicates that this conditional distribution does not very with <span class="math notranslate nohighlight">\(t\)</span>. The values <span class="math notranslate nohighlight">\(p_{ij}\)</span> are called <strong>transition probabilities</strong>, which can be stored in a transition matrix <span class="math notranslate nohighlight">\(\boldsymbol{P}\)</span>. We can find the <span class="math notranslate nohighlight">\(t\)</span>-step transition probability <span class="math notranslate nohighlight">\(p_{ij}^{(t)} = [\boldsymbol{P}^t] _{ij}\)</span>, which is the probability that, starting in state <span class="math notranslate nohighlight">\(i\)</span>, the Markov chain is found in state <span class="math notranslate nohighlight">\(j\)</span> after <span class="math notranslate nohighlight">\(t\)</span> transitions.</p>
<p>A Markov chain with state space <span class="math notranslate nohighlight">\(V\)</span> and transition matrix <span class="math notranslate nohighlight">\(\boldsymbol{P}\)</span> can be represented by a labeled directed graph, where edges are given by transitions with nonzero probability <span class="math notranslate nohighlight">\(E = \left\{ (u,v) \mid p_{u,v} &gt;0 \right\}\)</span>. Note that self-loops are allowed for <span class="math notranslate nohighlight">\(p_{ii} &gt; 0\)</span>.</p>
<div class="figure align-default" id="mc-graph">
<a class="reference internal image-reference" href="../_images/mc-graph.png"><img alt="" src="../_images/mc-graph.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">Graphical representation of a Markov chain</span><a class="headerlink" href="#mc-graph" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="irreducibility">
<h3>Irreducibility<a class="headerlink" href="#irreducibility" title="Permalink to this headline">¶</a></h3>
<dl class="simple myst">
<dt>Definitions</dt><dd><ul>
<li><p>A state <span class="math notranslate nohighlight">\(j\)</span> is <strong>accessible</strong> from state <span class="math notranslate nohighlight">\(i\)</span> if there exists some <span class="math notranslate nohighlight">\(n \ge 0\)</span> such that <span class="math notranslate nohighlight">\(p_{ij}^{(t)} &gt; 0\)</span>.</p></li>
<li><p>Two states <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> <strong>communicate</strong> if they are accessible from each other, written as <span class="math notranslate nohighlight">\(i \leftrightarrow j\)</span>. In the graph-representation of the chain, we have <span class="math notranslate nohighlight">\(i \leftrightarrow j\)</span> if there are directed paths from <span class="math notranslate nohighlight">\(i\)</span> to <span class="math notranslate nohighlight">\(j\)</span> and from <span class="math notranslate nohighlight">\(j\)</span> to <span class="math notranslate nohighlight">\(i\)</span>.</p></li>
<li><p>Some states form a <strong>communication class</strong> if all states in that class communicate.</p></li>
<li><p>A Markov chain is <strong>irreducible</strong> if any state is accessible from any other in some finite number of transitions, i.e.</p>
<div class="math notranslate nohighlight">
\[\forall i, j, \exists t: \quad p_{ij}^{(t)} &gt; 0\]</div>
<p>Equivalently,</p>
<ul class="simple">
<li><p>all states belong to one communication class, or</p></li>
<li><p>its graph representation is a strongly connected graph.</p></li>
</ul>
</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="periodicity">
<h3>Periodicity<a class="headerlink" href="#periodicity" title="Permalink to this headline">¶</a></h3>
<dl class="simple myst">
<dt>Definition (Period)</dt><dd><p>The period <span class="math notranslate nohighlight">\(d(i)\)</span> of a state <span class="math notranslate nohighlight">\(i\)</span> of a homogeneous Markov chain is defined as</p>
<div class="math notranslate nohighlight">
\[
  d(i) = \mathrm{gcd} \left\{ t: p_{ii} ^{(t)} &gt;0 \right\}
  \]</div>
<p>where <span class="math notranslate nohighlight">\(\mathrm{gcd}\)</span> stands for greatest common divisor.</p>
</dd>
<dt>Definition (Periodic and aperiodic)</dt><dd><ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(d(i)&gt;1\)</span>, we say that state <span class="math notranslate nohighlight">\(i\)</span> is periodic. That is, there is a period <span class="math notranslate nohighlight">\(d(i)\)</span> such that starting in state <span class="math notranslate nohighlight">\(i\)</span>, the chain can return to <span class="math notranslate nohighlight">\(i\)</span> only at multiples of the period <span class="math notranslate nohighlight">\(d(i)\)</span>, and <span class="math notranslate nohighlight">\(d(i)\)</span> is the largest such integer.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(d(i)=1\)</span>, we say that state <span class="math notranslate nohighlight">\(i\)</span> is aperiodic.</p></li>
<li><p>A Markov chain is aperiodic if all its states are aperiodic.</p></li>
</ul>
</dd>
<dt>Claims</dt><dd><ul>
<li><p>If <span class="math notranslate nohighlight">\(p_{ii} &gt; 0\)</span> then <span class="math notranslate nohighlight">\(x\)</span> is aperiodic. Converse is not true.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(i \leftrightarrow j\)</span>, then <span class="math notranslate nohighlight">\(d(i) = d(j)\)</span>.</p></li>
<li><p>If a finite Markov chain is aperiodic, then there exists a positive integer <span class="math notranslate nohighlight">\(m\)</span>, such that for all states <span class="math notranslate nohighlight">\(i\)</span>, it is guaranteed to return to that state in a finite number of transitions, i.e.</p>
<div class="math notranslate nohighlight">
\[\exists m, \forall i, t \ge m: \quad p_{ii}^{(t)} &gt; 0\]</div>
</li>
<li><p>If a Markov chain is irreducible and aperiodic, then there exists an integer <span class="math notranslate nohighlight">\(m\)</span>, such that any state is accessible from any other after at least <span class="math notranslate nohighlight">\(m\)</span> transitions, i.e.</p>
<div class="math notranslate nohighlight">
\[
    \exists m, \forall i, t \ge m: \quad \quad p_{ij}^{(t)} &gt; 0
    \]</div>
<p><em><strong>Proof</strong></em></p>
<div class="math notranslate nohighlight">
\[
    \underbrace{\mathbb{P} \left[X_{m}=j \mid X_{0}=i\right]}_{p_{i, j}^{(m)}} \geqslant \underbrace{\mathbb{P} \left[X_{m}=j \mid X_{m-n_{i, j}}=i\right]}_{\text{irreducible: } p_{i, j}^{(n_{i, j})}&gt;0} \cdot \underbrace{\mathbb{P} \left[X_{m-n_{i, j}}=i \mid X_{0}=i\right]}_{\text{aperiodic: } p_{i, i}^{(m-n_{i, j})}&gt;0} .
    \]</div>
<p><span class="math notranslate nohighlight">\(\square\)</span></p>
</li>
</ul>
</dd>
</dl>
</div>
</div>
<div class="section" id="stationary-distribution">
<h2>Stationary Distribution<a class="headerlink" href="#stationary-distribution" title="Permalink to this headline">¶</a></h2>
<dl class="simple myst">
<dt>Definition (Stationary distribution)</dt><dd><p>A row vector <span class="math notranslate nohighlight">\(\boldsymbol{\pi} ^{\top}\)</span> is called a <strong>stationary distribution</strong> for a Markov chain with transition matrix <span class="math notranslate nohighlight">\(\boldsymbol{P}\)</span> if</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\pi_j \ge 0\)</span> and <span class="math notranslate nohighlight">\(\sum_j\pi_j = 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{\pi} ^{\top} \boldsymbol{P} = \boldsymbol{\pi}^{\top}\)</span></p></li>
</ul>
</dd>
</dl>
<p>For instance, when <span class="math notranslate nohighlight">\(\boldsymbol{P} = \boldsymbol{I}\)</span>, then every probability distribution on the states is a stationary probability distribution.</p>
<dl class="simple myst">
<dt>Existence and uniqueness</dt><dd><p>If a Markov chain is <strong>aperiodic</strong> and <strong>irreducible</strong>, then it has precisely <strong>one</strong> stationary distribution, in the sense that the limit</p>
<div class="math notranslate nohighlight">
\[
  \lim _{n \rightarrow \infty} p_{ij}^{(n)} = \pi _j
  \]</div>
<p>exists for each state <span class="math notranslate nohighlight">\(j\)</span> with <span class="math notranslate nohighlight">\(\pi_j \ge 0\)</span> and <span class="math notranslate nohighlight">\(\sum_j\pi_j = 1\)</span>, which is independent of starting state <span class="math notranslate nohighlight">\(i\)</span>. Equivalently,</p>
<div class="math notranslate nohighlight">
\[
  \lim _{n \rightarrow \infty} \boldsymbol{P}^n  = \boldsymbol{1} \boldsymbol{\pi} ^{\top}
  \]</div>
</dd>
</dl>
</div>
<div class="section" id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h2>
<div class="section" id="infect-1000">
<h3>Infect 1000<a class="headerlink" href="#infect-1000" title="Permalink to this headline">¶</a></h3>
<p><em>There are 1,000 people in one room. One of them carries a disease which infects 100% if one shares hands with an infected person. In each minute all the people in the room are randomly paired to share hands with each other. What is your estimate of the expected number of people infected after 10 minutes? Can you use only pen and paper to solve this?</em></p>
<div class="section" id="sol-1-markov-chain">
<h4>Sol.1 Markov Chain<a class="headerlink" href="#sol-1-markov-chain" title="Permalink to this headline">¶</a></h4>
<p>Let <span class="math notranslate nohighlight">\(I_t\)</span> be the number of infected individuals after <span class="math notranslate nohighlight">\(t\)</span> minutes. Define a transition matrix <span class="math notranslate nohighlight">\(\boldsymbol{P}=\left\{ p_{i,j} \right\}\)</span>, where</p>
<div class="math notranslate nohighlight">
\[p_{i,j} = \mathrm{P}(I_{t+1}=j\vert I_t=i)\]</div>
<p>It’s easy to see that</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p_{1,2}=1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(p_{2,2}=\frac{1}{999}, p_{2,4}=\frac{998}{999}\)</span></p></li>
</ul>
<p>In general, we have, for <span class="math notranslate nohighlight">\(l=0,1,\ldots, \min(k, \frac{n}{2}-k)\)</span>,</p>
<div class="math notranslate nohighlight">
\[p_{2k, 2(t+l)}= \frac{C_{2k}^{2l} C_{n-2k}^{2l} P_{2l}^{2l} R_{2k-2l} R_{n-2k-2l}}{R_{n}}\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C_{2k}^{2l}\)</span> is the number of ways to select <span class="math notranslate nohighlight">\(2l\)</span> infected individuals from the total <span class="math notranslate nohighlight">\(2k\)</span> infected individuals, to be paired with <span class="math notranslate nohighlight">\(2l\)</span> healthy individuals</p></li>
<li><p><span class="math notranslate nohighlight">\(C_{n-2k}^{2l}\)</span> is the number of ways to select <span class="math notranslate nohighlight">\(2l\)</span> healthy individuals from the total <span class="math notranslate nohighlight">\(n-2k\)</span> healthy individuals, to be paired with <span class="math notranslate nohighlight">\(2l\)</span> infected individuals</p></li>
<li><p><span class="math notranslate nohighlight">\(P_{2l}^{2l}\)</span> is the number of ways to pair <span class="math notranslate nohighlight">\(2l\)</span> infected individuals and <span class="math notranslate nohighlight">\(2l\)</span> healthy individuals, such that additional <span class="math notranslate nohighlight">\(2l\)</span> individuals are infected</p></li>
<li><p><span class="math notranslate nohighlight">\(R_m\)</span> is the number of ways to arrange a even number <span class="math notranslate nohighlight">\(m\)</span> of individuals into <span class="math notranslate nohighlight">\(\frac{m}{2}\)</span> pairs. It’s easy to find</p></li>
</ul>
<div class="math notranslate nohighlight">
\[R_m=\frac{C_m^2C_{m-2}^2\ldots C_2^2 }{\frac{m}{2}!} = \frac{m!}{(2!)^{\frac{m}{2}}(\frac{m}{2}!)}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_{2k-2l}\)</span> is the number of ways to arrange <span class="math notranslate nohighlight">\(2k-2l\)</span> infected individuals into pairs, who do not share hands with healthy individuals</p></li>
<li><p><span class="math notranslate nohighlight">\(R_{n-2k-2l}\)</span> is the number of ways to arrange <span class="math notranslate nohighlight">\(n-2k-2l\)</span> healthy individuals into pairs, who do not share hands with infected individuals and keep being healthy</p></li>
<li><p><span class="math notranslate nohighlight">\(R_n\)</span> is the total number of ways to arrange <span class="math notranslate nohighlight">\(n\)</span> people into <span class="math notranslate nohighlight">\(n/2\)</span> pairs in the room</p></li>
</ul>
<p>Simplification gives</p>
<div class="math notranslate nohighlight">
\[p_{2k, 2(k+l)} =\frac{C_{n/2}^{k+l}C_{k+l}^{2l}4^l}{C_n^{2k}}\]</div>
<p>Then the distribution of <span class="math notranslate nohighlight">\(I_{10}\)</span> is</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{p}_{I_{10}}^\top=\boldsymbol{e}_1^\top \boldsymbol{P}^{10}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{e}_1 = [1,0,\ldots,0]\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{p}_{I_{10}} = [p_{1,1}^{(10)}, \ldots, p_{1,n}^{(10)}]\)</span></p>
<p>The expected number is</p>
<div class="math notranslate nohighlight">
\[\mathrm{E}(I_{10}) = [1,2,3,\ldots, n]^\top\boldsymbol{p}_{I_{10}} \]</div>
<p>A python script to implement the above steps:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.sparse</span> <span class="k">as</span> <span class="nn">sparse</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">comb</span><span class="p">,</span> <span class="n">perm</span><span class="p">,</span> <span class="n">factorial</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">ks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span>
        <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="n">l</span><span class="p">))</span>
        <span class="n">ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="n">l</span><span class="p">)</span> <span class="o">*</span> <span class="n">comb</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="n">l</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="o">**</span><span class="n">l</span> <span class="o">/</span> <span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">))</span>

<span class="n">P</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">((</span><span class="n">ps</span><span class="p">,</span> <span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">Pt</span> <span class="o">=</span> <span class="n">P</span><span class="o">**</span><span class="n">t</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">Et</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">i</span> <span class="o">*</span> <span class="n">distribution</span><span class="o">.</span><span class="n">toarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Et</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>642.3471200227277
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sol-2-conditional-expectation">
<h4>Sol.2 Conditional Expectation<a class="headerlink" href="#sol-2-conditional-expectation" title="Permalink to this headline">¶</a></h4>
<p>Let <span class="math notranslate nohighlight">\(p_{t,j}\)</span> be the probability that infected individual <span class="math notranslate nohighlight">\(j\)</span> is paired with a <strong>healthy</strong> individual from time <span class="math notranslate nohighlight">\(t\)</span> to <span class="math notranslate nohighlight">\(t+1\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[p_{t,j} = \frac{n-I_t} {n - 1} =: p_t\]</div>
<p>Let <span class="math notranslate nohighlight">\(I_{t+1, j}\)</span> be the number of individuals infected by infected individual <span class="math notranslate nohighlight">\(j\)</span> from time <span class="math notranslate nohighlight">\(t\)</span> to <span class="math notranslate nohighlight">\(t+1\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
I_{t+1,j}=\begin{cases}
1 &amp; p_{t}\\
0 &amp; 1-p_{t}
\end{cases}
\end{split}\]</div>
<p>Hence,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\mathrm{E}\left( I_{t+1, j} \right) &amp;= p_{t} \times 1 + (1-p_{t}) \times 0  \\
&amp; = p_{t} \\
\end{align}
\end{split}\]</div>
<p>Therefore, the conditional expectation of the total number of infected individuals is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\mathrm{E}(I_{t+1}|I_t) &amp; = \mathrm{E}\left( I_t +  \sum_{j=1}^{I_t} I_{t+1,j} \right)\\
&amp;= I_t + \sum_{j=1}^{I_t} \mathrm{E}\left( I_{t+1, j} \right) \\
&amp; = I_t + I_t \times p_t \\
&amp; = I_t + I_t \times \frac{n-I_t}{n - 1} \\
\end{align}
\end{split}\]</div>
<p>How to solve it?</p>
<p>By the law of total expectation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\mathrm{E}(I_{t+1}) &amp; = \mathrm{E}\left( \mathrm{E}(I_{t+1}|I_t) \right) \\
&amp; = \mathrm{E}\left(I_t + I_t \times \frac{n-I_t}{n - 1} \right)\\
&amp; = \frac{2n-1}{n-1}\mathrm{E}\left( I_t \right) - \frac{1}{n-1}\mathrm{E}\left( I_t^2 \right)
\end{align}
\end{split}\]</div>
<p>In particular, since <span class="math notranslate nohighlight">\(\mathrm{P}(I_1=2\vert I_0=1)=1\)</span>, there is no randomness in <span class="math notranslate nohighlight">\(I_1\)</span>, such that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\mathrm{E}(I_2) &amp;= \mathrm{E}\left( \mathrm{E}(I_2\vert I_1) \right) \\
&amp;= \mathrm{E}\left(I_1 + I_1 \times \frac{n-I_1}{n - 1}\right)\\
&amp; = 2 + 2 \times 998 / 999 \\
&amp; = 3994/999
\end{align}
\end{split}\]</div>
<p>But when <span class="math notranslate nohighlight">\(t\ge 3\)</span>, the computation become complicated due to the second-order term <span class="math notranslate nohighlight">\(\mathrm{E}\left( I_t^2 \right)\)</span></p>
<p>One attempt is to approximate <span class="math notranslate nohighlight">\(\mathrm{E}\left( I_t^2 \right)\)</span> by <span class="math notranslate nohighlight">\(\left[ \mathrm{E}\left( I_t \right) \right]^2\)</span> such that we have a <strong>recurrence relation</strong></p>
<div class="math notranslate nohighlight">
\[\mathrm{E}\left( I_{t+1} \right) \approx \frac{2n-1}{n-1}\mathrm{E}\left( I_t \right) - \frac{1}{n-1}\left[ \mathrm{E}\left( I_t \right) \right]^2\]</div>
<p>Note that this will lead to a larger result since <span class="math notranslate nohighlight">\(\mathrm{E}\left( I_t^2 \right) - \left[ \mathrm{E}\left( I_t \right) \right]^2 = \mathrm{Var}\left( I_t \right) \ge 0\)</span>. But since <span class="math notranslate nohighlight">\(\mathrm{Var}\left( I_t \right)\)</span> is small, the positive error is also small.</p>
<p>A python script of the iteration is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">I0</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Is</span> <span class="o">=</span> <span class="p">[</span><span class="n">I0</span><span class="p">]</span> <span class="c1"># initial number of infected</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">Is</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Is</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">Is</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">Is</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">Is</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">10</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>642.9754330548355
</pre></div>
</div>
</div>
</div>
<p>The result <span class="math notranslate nohighlight">\(642.975\)</span> is slightly larger than the result <span class="math notranslate nohighlight">\(642.347\)</span> in Solution 1.</p>
<p>If we take a closer look at the recurrence relation, dividing <span class="math notranslate nohighlight">\(2n-1\)</span> on both sides gives</p>
<div class="math notranslate nohighlight">
\[\frac{\mathrm{E}\left( I_{t+1} \right)}{2n-1} \approx \frac{2n-1}{n-1} \frac{\mathrm{E}\left( I_t \right)}{2n-1} - \frac{2n-1}{n-1}\left[ \frac{\mathrm{E}\left( I_t \right)}{2n-1} \right]^2\]</div>
<p>Let <span class="math notranslate nohighlight">\(x_t = \frac{\mathrm{E}\left( I_t \right)}{2n-1}\)</span> then it becomes</p>
<div class="math notranslate nohighlight">
\[x_{t+1} \approx 2x_t(1-x_t)\]</div>
<p>when <span class="math notranslate nohighlight">\(n\)</span> is large.</p>
<p>Given <span class="math notranslate nohighlight">\(x_0\)</span>, if the equality holds, we can solve for <span class="math notranslate nohighlight">\(x_t\)</span> by</p>
<div class="math notranslate nohighlight">
\[x_{t} = \frac{1}{2}\left\{1-\exp \left[2^{t} \ln \left(1-2 x_{0}\right)\right]\right\}\]</div>
<p>For details, see <a class="reference external" href="https://mathworld.wolfram.com/LogisticMap.html">Logistic Map</a>.</p>
</div>
<div class="section" id="sol-3-simulation">
<h4>Sol.3 Simulation<a class="headerlink" href="#sol-3-simulation" title="Permalink to this headline">¶</a></h4>
<p>To verify the solutions above, we can simulate the infection process.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">Population</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">infected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># indexes of infected individuals</span>

    <span class="k">def</span> <span class="nf">count_infected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">infected</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">infect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">return_records</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        simulate infection for t minutes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">It_records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="n">perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="n">perm_pairs</span> <span class="o">=</span> <span class="n">perm</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># random pairs</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">perm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">infected</span><span class="p">,</span> <span class="n">assume_unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">status_pairs</span> <span class="o">=</span> <span class="n">status</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">new_pairs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_xor</span><span class="p">(</span><span class="n">status_pairs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">status_pairs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">new_boolean</span> <span class="o">=</span> <span class="o">~</span><span class="n">status_pairs</span><span class="p">[</span><span class="n">new_pairs</span><span class="p">]</span>
            <span class="n">new_individuals</span> <span class="o">=</span> <span class="n">perm_pairs</span><span class="p">[</span><span class="n">new_pairs</span><span class="p">][</span><span class="n">new_boolean</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">infected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">infected</span><span class="p">,</span> <span class="n">new_individuals</span><span class="p">))</span>
            <span class="n">It_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count_infected</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">return_records</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">It_records</span><span class="p">)</span>



<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">Population</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">pop</span><span class="o">.</span><span class="n">infect</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">count_infected</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>658
</pre></div>
</div>
</div>
</div>
<p>To get the expected number <span class="math notranslate nohighlight">\(E(I_{10})\)</span>, we can try to simulate <span class="math notranslate nohighlight">\(m\)</span> times and take the average.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">Its</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">m</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">pop</span> <span class="o">=</span> <span class="n">Population</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">Its</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">infect</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">return_records</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Its</span><span class="p">[:,</span> <span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>642.2862
</pre></div>
</div>
</div>
</div>
<p>We see the simulation result <span class="math notranslate nohighlight">\(642.286\)</span> is quite close to the result <span class="math notranslate nohighlight">\(E(I_{10}) = 642.347\)</span> in Solution 1.</p>
<p>The plot below shows <span class="math notranslate nohighlight">\(m\)</span> trajectories of <span class="math notranslate nohighlight">\(I_t\)</span> in the simulation. We can see all lines are close to each other, which verifies that the variance is quite small.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Its</span><span class="p">[</span><span class="n">row</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;infected number $I_t$&#39;</span><span class="p">)</span>    
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;time $t$&#39;</span><span class="p">)</span>    
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/51-markov-chain_13_0.png" src="../_images/51-markov-chain_13_0.png" />
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./12-probabilities"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="31-bayesian-theorem.html" title="previous page">Bayesian’s Theorem</a>
    <a class='right-next' id="next-link" href="71-sampling.html" title="next page">Sampling</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dennis Zheng<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>