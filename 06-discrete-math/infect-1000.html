<!DOCTYPE html>
<html data-markdown-preview-plus-context="html-export">
  <head>
    <meta charset="utf-8" />
    <title>infect-1000</title><script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX","output/HTML-CSS"],
    extensions: ["[a11y]/accessibility-menu.js"],
    'HTML-CSS': {
      availableFonts: [],
      webFont: 'TeX',
      undefinedFamily: "serif",
      mtextFontInherit: true,
    },
    TeX: {
  "Macros": {},
  "equationNumbers": {},
  "extensions": [
    "AMSmath.js",
    "AMSsymbols.js",
    "noErrors.js",
    "noUndefined.js"
  ]
},
    showMathMenu: true
  });
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js"></script>
    <style>.emoji {
  max-width: 1em !important;
}
del {
  text-decoration: none;
  position: relative;
}
del::after {
  border-bottom: 1px solid black;
  content: '';
  left: 0;
  position: absolute;
  right: 0;
  top: 50%;
}
ul.contains-task-list li.task-list-item {
  position: relative;
  list-style-type: none;
}
ul.contains-task-list li.task-list-item input.task-list-item-checkbox {
  position: absolute;
  transform: translateX(-100%);
  width: 30px;
}
span.critic.comment {
  position: relative;
}
span.critic.comment::before {
  content: '\1f4ac';
  position: initial;
}
span.critic.comment > span {
  display: none;
}
span.critic.comment:hover > span {
  display: initial;
  position: absolute;
  top: 100%;
  left: 0;
  border: 1px solid;
  border-radius: 5px;
  max-height: 4em;
  overflow: auto;
}
span.critic.comment:focus > span {
  display: initial;
  text-decoration: underline;
  position: initial;
  top: auto;
  left: auto;
  border: initial;
  border-radius: initial;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
  background-color: transparent;
}

body {
  padding: 2em;
  font-size: 1.2em;
  color: #abb2bf;
  background-color: #282c34;
  overflow: auto;
}
body > :first-child,
body > div.update-preview > :first-child {
  margin-top: 0;
}
body > p,
body > div.update-preview > p {
  margin-top: 0;
  margin-bottom: 1.5em;
}
body > ul,
body > div.update-preview > ul,
body > ol,
body > div.update-preview > ol {
  margin-bottom: 1.5em;
}
h1,
h2,
h3,
h4,
h5,
h6 {
  line-height: 1.2;
  margin-top: 1.5em;
  margin-bottom: 0.5em;
  color: #ffffff;
}
h1 {
  font-size: 2.4em;
  font-weight: 300;
}
h2 {
  font-size: 1.8em;
  font-weight: 400;
}
h3 {
  font-size: 1.5em;
  font-weight: 500;
}
h4 {
  font-size: 1.2em;
  font-weight: 600;
}
h5 {
  font-size: 1.1em;
  font-weight: 600;
}
h6 {
  font-size: 1em;
  font-weight: 600;
}
strong {
  color: #ffffff;
}
del {
  color: #7c879c;
}
a,
a code {
  color: #528bff;
}
img {
  max-width: 100%;
}
blockquote {
  margin: 1.5em 0;
  font-size: inherit;
  color: #7c879c;
  border-color: #4b5362;
  border-width: 4px;
}
hr {
  margin: 3em 0;
  border-top: 2px dashed #4b5362;
  background: none;
}
table {
  margin: 1.5em 0;
}
th {
  color: #ffffff;
}
th,
td {
  padding: 0.66em 1em;
  border: 1px solid #4b5362;
}
code {
  color: #ffffff;
  background-color: #3a3f4b;
}
pre.editor-colors {
  margin: 1.5em 0;
  padding: 1em;
  font-size: 0.92em;
  border-radius: 3px;
  background-color: #31363f;
}
kbd {
  color: #ffffff;
  border: 1px solid #4b5362;
  border-bottom: 2px solid #3e4451;
  background-color: #3a3f4b;
}

.bracket-matcher .region {
  border-bottom: 1px dotted lime;
  position: absolute;
}
.line-number.bracket-matcher.bracket-matcher {
  color: #abb2bf;
  background-color: #3a3f4b;
}

.spell-check-misspelling .region {
  border-bottom: 2px dotted rgba(255, 51, 51, 0.75);
}
.spell-check-corrections {
  width: 25em !important;
}

pre.editor-colors .gutter .line-number {
  /* Use CSS specificity to force errors to override warnings and info markers */
  /* Use CSS specificity to force warnings to override info markes. */
}
pre.editor-colors .gutter .line-number.latex-error,
pre.editor-colors .gutter .line-number.latex-error.latex-warning,
pre.editor-colors .gutter .line-number.latex-error.latex-info,
pre.editor-colors .gutter .line-number.latex-error.latex-warning.latex-info {
  border-left: 2px solid #d13b2e;
  padding-left: calc(0.5em - 2px);
}
pre.editor-colors .gutter .line-number.latex-warning,
pre.editor-colors .gutter .line-number.latex-warning.latex-info {
  border-left: 2px solid #ad7c0b;
  padding-left: calc(0.5em - 2px);
}
pre.editor-colors .gutter .line-number.latex-info {
  border-left: 2px solid #0f82e6;
  padding-left: calc(0.5em - 2px);
}

pre.editor-colors {
  background-color: #282c34;
  color: #abb2bf;
}
pre.editor-colors .line.cursor-line {
  background-color: rgba(153, 187, 255, 0.04);
}
pre.editor-colors .invisible {
  color: #abb2bf;
}
pre.editor-colors .cursor {
  border-left: 2px solid #528bff;
}
pre.editor-colors .selection .region {
  background-color: #3e4451;
}
pre.editor-colors .bracket-matcher .region {
  border-bottom: 1px solid #528bff;
  box-sizing: border-box;
}
pre.editor-colors .invisible-character {
  color: rgba(171, 178, 191, 0.15);
}
pre.editor-colors .indent-guide {
  color: rgba(171, 178, 191, 0.15);
}
pre.editor-colors .wrap-guide {
  background-color: rgba(171, 178, 191, 0.15);
}
pre.editor-colors .find-result .region.region.region,
pre.editor-colors .current-result .region.region.region {
  border-radius: 2px;
  background-color: rgba(82, 139, 255, 0.24);
  transition: border-color 0.4s;
}
pre.editor-colors .find-result .region.region.region {
  border: 2px solid transparent;
}
pre.editor-colors .current-result .region.region.region {
  border: 2px solid #528bff;
  transition-duration: .1s;
}
pre.editor-colors .gutter .line-number {
  color: #636d83;
  -webkit-font-smoothing: antialiased;
}
pre.editor-colors .gutter .line-number.cursor-line {
  color: #abb2bf;
  background-color: #3a3f4b;
}
pre.editor-colors .gutter .line-number.cursor-line-no-selection {
  background-color: transparent;
}
pre.editor-colors .gutter .line-number .icon-right {
  color: #abb2bf;
}
pre.editor-colors .gutter:not(.git-diff-icon) .line-number.git-line-removed.git-line-removed::before {
  bottom: -3px;
}
pre.editor-colors .gutter:not(.git-diff-icon) .line-number.git-line-removed::after {
  content: "";
  position: absolute;
  left: 0px;
  bottom: 0px;
  width: 25px;
  border-bottom: 1px dotted rgba(224, 82, 82, 0.5);
  pointer-events: none;
}
pre.editor-colors .gutter .line-number.folded,
pre.editor-colors .gutter .line-number:after,
pre.editor-colors .fold-marker:after {
  color: #abb2bf;
}
.syntax--comment {
  color: #5c6370;
  font-style: italic;
}
.syntax--comment .syntax--markup.syntax--link {
  color: #5c6370;
}
.syntax--entity.syntax--name.syntax--type {
  color: #e5c07b;
}
.syntax--entity.syntax--other.syntax--inherited-class {
  color: #e5c07b;
}
.syntax--keyword {
  color: #c678dd;
}
.syntax--keyword.syntax--control {
  color: #c678dd;
}
.syntax--keyword.syntax--operator {
  color: #c678dd;
}
.syntax--keyword.syntax--other.syntax--special-method {
  color: #61afef;
}
.syntax--keyword.syntax--other.syntax--unit {
  color: #d19a66;
}
.syntax--storage {
  color: #c678dd;
}
.syntax--storage.syntax--type.syntax--annotation,
.syntax--storage.syntax--type.syntax--primitive {
  color: #c678dd;
}
.syntax--storage.syntax--modifier.syntax--package,
.syntax--storage.syntax--modifier.syntax--import {
  color: #abb2bf;
}
.syntax--constant {
  color: #d19a66;
}
.syntax--constant.syntax--variable {
  color: #d19a66;
}
.syntax--constant.syntax--character.syntax--escape {
  color: #56b6c2;
}
.syntax--constant.syntax--numeric {
  color: #d19a66;
}
.syntax--constant.syntax--other.syntax--color {
  color: #56b6c2;
}
.syntax--constant.syntax--other.syntax--symbol {
  color: #56b6c2;
}
.syntax--variable {
  color: #e06c75;
}
.syntax--variable.syntax--interpolation {
  color: #be5046;
}
.syntax--variable.syntax--parameter {
  color: #abb2bf;
}
.syntax--string {
  color: #98c379;
}
.syntax--string > .syntax--source,
.syntax--string .syntax--embedded {
  color: #abb2bf;
}
.syntax--string.syntax--regexp {
  color: #56b6c2;
}
.syntax--string.syntax--regexp .syntax--source.syntax--ruby.syntax--embedded {
  color: #e5c07b;
}
.syntax--string.syntax--other.syntax--link {
  color: #e06c75;
}
.syntax--punctuation.syntax--definition.syntax--comment {
  color: #5c6370;
}
.syntax--punctuation.syntax--definition.syntax--method-parameters,
.syntax--punctuation.syntax--definition.syntax--function-parameters,
.syntax--punctuation.syntax--definition.syntax--parameters,
.syntax--punctuation.syntax--definition.syntax--separator,
.syntax--punctuation.syntax--definition.syntax--seperator,
.syntax--punctuation.syntax--definition.syntax--array {
  color: #abb2bf;
}
.syntax--punctuation.syntax--definition.syntax--heading,
.syntax--punctuation.syntax--definition.syntax--identity {
  color: #61afef;
}
.syntax--punctuation.syntax--definition.syntax--bold {
  color: #e5c07b;
  font-weight: bold;
}
.syntax--punctuation.syntax--definition.syntax--italic {
  color: #c678dd;
  font-style: italic;
}
.syntax--punctuation.syntax--section.syntax--embedded {
  color: #be5046;
}
.syntax--punctuation.syntax--section.syntax--method,
.syntax--punctuation.syntax--section.syntax--class,
.syntax--punctuation.syntax--section.syntax--inner-class {
  color: #abb2bf;
}
.syntax--support.syntax--class {
  color: #e5c07b;
}
.syntax--support.syntax--type {
  color: #56b6c2;
}
.syntax--support.syntax--function {
  color: #56b6c2;
}
.syntax--support.syntax--function.syntax--any-method {
  color: #61afef;
}
.syntax--entity.syntax--name.syntax--function {
  color: #61afef;
}
.syntax--entity.syntax--name.syntax--class,
.syntax--entity.syntax--name.syntax--type.syntax--class {
  color: #e5c07b;
}
.syntax--entity.syntax--name.syntax--section {
  color: #61afef;
}
.syntax--entity.syntax--name.syntax--tag {
  color: #e06c75;
}
.syntax--entity.syntax--other.syntax--attribute-name {
  color: #d19a66;
}
.syntax--entity.syntax--other.syntax--attribute-name.syntax--id {
  color: #61afef;
}
.syntax--meta.syntax--class {
  color: #e5c07b;
}
.syntax--meta.syntax--class.syntax--body {
  color: #abb2bf;
}
.syntax--meta.syntax--method-call,
.syntax--meta.syntax--method {
  color: #abb2bf;
}
.syntax--meta.syntax--definition.syntax--variable {
  color: #e06c75;
}
.syntax--meta.syntax--link {
  color: #d19a66;
}
.syntax--meta.syntax--require {
  color: #61afef;
}
.syntax--meta.syntax--selector {
  color: #c678dd;
}
.syntax--meta.syntax--separator {
  color: #abb2bf;
}
.syntax--meta.syntax--tag {
  color: #abb2bf;
}
.syntax--underline {
  text-decoration: underline;
}
.syntax--none {
  color: #abb2bf;
}
.syntax--invalid.syntax--deprecated {
  color: #523d14 !important;
  background-color: #e0c285 !important;
}
.syntax--invalid.syntax--illegal {
  color: white !important;
  background-color: #e05252 !important;
}
.syntax--markup.syntax--bold {
  color: #d19a66;
  font-weight: bold;
}
.syntax--markup.syntax--changed {
  color: #c678dd;
}
.syntax--markup.syntax--deleted {
  color: #e06c75;
}
.syntax--markup.syntax--italic {
  color: #c678dd;
  font-style: italic;
}
.syntax--markup.syntax--heading {
  color: #e06c75;
}
.syntax--markup.syntax--heading .syntax--punctuation.syntax--definition.syntax--heading {
  color: #61afef;
}
.syntax--markup.syntax--link {
  color: #56b6c2;
}
.syntax--markup.syntax--inserted {
  color: #98c379;
}
.syntax--markup.syntax--quote {
  color: #d19a66;
}
.syntax--markup.syntax--raw {
  color: #98c379;
}
.syntax--source.syntax--c .syntax--keyword.syntax--operator {
  color: #c678dd;
}
.syntax--source.syntax--cpp .syntax--keyword.syntax--operator {
  color: #c678dd;
}
.syntax--source.syntax--cs .syntax--keyword.syntax--operator {
  color: #c678dd;
}
.syntax--source.syntax--css .syntax--property-name,
.syntax--source.syntax--css .syntax--property-value {
  color: #828997;
}
.syntax--source.syntax--css .syntax--property-name.syntax--support,
.syntax--source.syntax--css .syntax--property-value.syntax--support {
  color: #abb2bf;
}
.syntax--source.syntax--elixir .syntax--source.syntax--embedded.syntax--source {
  color: #abb2bf;
}
.syntax--source.syntax--elixir .syntax--constant.syntax--language,
.syntax--source.syntax--elixir .syntax--constant.syntax--numeric,
.syntax--source.syntax--elixir .syntax--constant.syntax--definition {
  color: #61afef;
}
.syntax--source.syntax--elixir .syntax--variable.syntax--definition,
.syntax--source.syntax--elixir .syntax--variable.syntax--anonymous {
  color: #c678dd;
}
.syntax--source.syntax--elixir .syntax--parameter.syntax--variable.syntax--function {
  color: #d19a66;
  font-style: italic;
}
.syntax--source.syntax--elixir .syntax--quoted {
  color: #98c379;
}
.syntax--source.syntax--elixir .syntax--keyword.syntax--special-method,
.syntax--source.syntax--elixir .syntax--embedded.syntax--section,
.syntax--source.syntax--elixir .syntax--embedded.syntax--source.syntax--empty {
  color: #e06c75;
}
.syntax--source.syntax--elixir .syntax--readwrite.syntax--module .syntax--punctuation {
  color: #e06c75;
}
.syntax--source.syntax--elixir .syntax--regexp.syntax--section,
.syntax--source.syntax--elixir .syntax--regexp.syntax--string {
  color: #be5046;
}
.syntax--source.syntax--elixir .syntax--separator,
.syntax--source.syntax--elixir .syntax--keyword.syntax--operator {
  color: #d19a66;
}
.syntax--source.syntax--elixir .syntax--variable.syntax--constant {
  color: #e5c07b;
}
.syntax--source.syntax--elixir .syntax--array,
.syntax--source.syntax--elixir .syntax--scope,
.syntax--source.syntax--elixir .syntax--section {
  color: #828997;
}
.syntax--source.syntax--gfm .syntax--markup {
  -webkit-font-smoothing: auto;
}
.syntax--source.syntax--gfm .syntax--link .syntax--entity {
  color: #61afef;
}
.syntax--source.syntax--go .syntax--storage.syntax--type.syntax--string {
  color: #c678dd;
}
.syntax--source.syntax--ini .syntax--keyword.syntax--other.syntax--definition.syntax--ini {
  color: #e06c75;
}
.syntax--source.syntax--java .syntax--storage.syntax--modifier.syntax--import {
  color: #e5c07b;
}
.syntax--source.syntax--java .syntax--storage.syntax--type {
  color: #e5c07b;
}
.syntax--source.syntax--java .syntax--keyword.syntax--operator.syntax--instanceof {
  color: #c678dd;
}
.syntax--source.syntax--java-properties .syntax--meta.syntax--key-pair {
  color: #e06c75;
}
.syntax--source.syntax--java-properties .syntax--meta.syntax--key-pair > .syntax--punctuation {
  color: #abb2bf;
}
.syntax--source.syntax--js .syntax--keyword.syntax--operator {
  color: #56b6c2;
}
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--delete,
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--in,
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--of,
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--instanceof,
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--new,
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--typeof,
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--void {
  color: #c678dd;
}
.syntax--source.syntax--ts .syntax--keyword.syntax--operator {
  color: #56b6c2;
}
.syntax--source.syntax--flow .syntax--keyword.syntax--operator {
  color: #56b6c2;
}
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--dictionary.syntax--json > .syntax--string.syntax--quoted.syntax--json {
  color: #e06c75;
}
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--dictionary.syntax--json > .syntax--string.syntax--quoted.syntax--json > .syntax--punctuation.syntax--string {
  color: #e06c75;
}
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--dictionary.syntax--json > .syntax--value.syntax--json > .syntax--string.syntax--quoted.syntax--json,
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--array.syntax--json > .syntax--value.syntax--json > .syntax--string.syntax--quoted.syntax--json,
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--dictionary.syntax--json > .syntax--value.syntax--json > .syntax--string.syntax--quoted.syntax--json > .syntax--punctuation,
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--array.syntax--json > .syntax--value.syntax--json > .syntax--string.syntax--quoted.syntax--json > .syntax--punctuation {
  color: #98c379;
}
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--dictionary.syntax--json > .syntax--constant.syntax--language.syntax--json,
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--array.syntax--json > .syntax--constant.syntax--language.syntax--json {
  color: #56b6c2;
}
.syntax--ng.syntax--interpolation {
  color: #e06c75;
}
.syntax--ng.syntax--interpolation.syntax--begin,
.syntax--ng.syntax--interpolation.syntax--end {
  color: #61afef;
}
.syntax--ng.syntax--interpolation .syntax--function {
  color: #e06c75;
}
.syntax--ng.syntax--interpolation .syntax--function.syntax--begin,
.syntax--ng.syntax--interpolation .syntax--function.syntax--end {
  color: #61afef;
}
.syntax--ng.syntax--interpolation .syntax--bool {
  color: #d19a66;
}
.syntax--ng.syntax--interpolation .syntax--bracket {
  color: #abb2bf;
}
.syntax--ng.syntax--pipe,
.syntax--ng.syntax--operator {
  color: #abb2bf;
}
.syntax--ng.syntax--tag {
  color: #56b6c2;
}
.syntax--ng.syntax--attribute-with-value .syntax--attribute-name {
  color: #e5c07b;
}
.syntax--ng.syntax--attribute-with-value .syntax--string {
  color: #c678dd;
}
.syntax--ng.syntax--attribute-with-value .syntax--string.syntax--begin,
.syntax--ng.syntax--attribute-with-value .syntax--string.syntax--end {
  color: #abb2bf;
}
.syntax--source.syntax--ruby .syntax--constant.syntax--other.syntax--symbol > .syntax--punctuation {
  color: inherit;
}
.syntax--source.syntax--php .syntax--class.syntax--bracket {
  color: #abb2bf;
}
.syntax--source.syntax--python .syntax--keyword.syntax--operator.syntax--logical.syntax--python {
  color: #c678dd;
}
.syntax--source.syntax--python .syntax--variable.syntax--parameter {
  color: #d19a66;
}

body:not([class]) {
  font-family: "Helvetica Neue", Helvetica, sans-serif;
  font-size: 14px;
}
html,
html * {
  background: rgba(0, 0, 0, 0) !important;
}
atom-pane,
atom-panel,
atom-notification {
  background: #000000 !important;
}
atom-overlay > * {
  background: rgba(0, 0, 0, 0.5) !important;
}
pre.editor-colors.editor .cursor-line {
  background-color: rgba(200, 200, 200, 0.2) !important;
}
pre.editor-colors.editor .selection .region {
  background-color: rgba(255, 255, 255, 0.3) !important;
}
pre.editor-colors.editor .gutter {
  background-color: #000000 !important;
}
</style>

  </head>
  <body>
    <h1 id="infect-1000">Infect 1000</h1>
<p><em>There are 1,000 people in one room. One of them carries a disease which infects 100% if one shakes hands with an infected person. In each minute all the people in the room are randomly paired to shake hands with each other. What is your estimate of the expected number of people infected after 10 minutes? Can you use only pen and paper to solve this?</em></p>
<h2 id="solution-1%3A-markov-chain">Solution 1: Markov Chain</h2>
<p>Let <span class="math inline-math"><script type="math/tex">I_t</script></span> be the number of infected individuals after <span class="math inline-math"><script type="math/tex">t</script></span> minutes. Define a transition matrix <span class="math inline-math"><script type="math/tex">P</script></span>, where</p>
<span class="math display-math"><script type="math/tex; mode=display">p_{i,j} = \operatorname{P}(I_{t+1}=j\vert I_t=i)
</script></span>
<p>It’s easy to see that</p>
<ul>
<li><span class="math inline-math"><script type="math/tex">p_{1,2}=1</script></span></li>
<li><span class="math inline-math"><script type="math/tex">p_{2,2}=\frac{1}{999}, p_{2,4}=\frac{998}{999}</script></span></li>
</ul>
<p>In general, we have, for <span class="math inline-math"><script type="math/tex">l=0,1,\ldots, \min(k, \frac{n}{2}-k)</script></span>,</p>
<span class="math display-math"><script type="math/tex; mode=display">p_{2k, 2(k+l)}= \frac{C_{2k}^{2l} C_{n-2k}^{2l} P_{2l}^{2l} R_{2k-2l} R_{n-2k-2l}}{R_{n}}
</script></span>
<p>where</p>
<ul>
<li><span class="math inline-math"><script type="math/tex">C_{2k}^{2l}</script></span> is the number of ways to select <span class="math inline-math"><script type="math/tex">2l</script></span> infected individuals from the total <span class="math inline-math"><script type="math/tex">2k</script></span> infected individuals, to be paired with <span class="math inline-math"><script type="math/tex">2l</script></span> healthy individuals</li>
<li><span class="math inline-math"><script type="math/tex">C_{n-2k}^{2l}</script></span> is the number of ways to select <span class="math inline-math"><script type="math/tex">2l</script></span> healthy individuals from the total <span class="math inline-math"><script type="math/tex">n-2k</script></span> healthy individuals, to be paired with <span class="math inline-math"><script type="math/tex">2l</script></span> infected individuals</li>
<li><span class="math inline-math"><script type="math/tex">P_{2l}^{2l}</script></span> is the number of ways to pair <span class="math inline-math"><script type="math/tex">2l</script></span> infected individuals and <span class="math inline-math"><script type="math/tex">2l</script></span> healthy individuals, such that additional <span class="math inline-math"><script type="math/tex">2l</script></span> individuals are infected</li>
<li><span class="math inline-math"><script type="math/tex">R_m</script></span> is the number of ways to arrange a even number <span class="math inline-math"><script type="math/tex">m</script></span> of individuals into <span class="math inline-math"><script type="math/tex">\frac{m}{2}</script></span> pairs. It’s easy to find</li>
</ul>
<span class="math display-math"><script type="math/tex; mode=display">R_m=\frac{C_m^2C_{m-2}^2\ldots C_2^2 }{\frac{m}{2}!} = \frac{m!}{(2!)^{\frac{m}{2}}(\frac{m}{2}!)}
</script></span>
<ul>
<li><span class="math inline-math"><script type="math/tex">R_{2k-2l}</script></span> is the number of ways to arrange <span class="math inline-math"><script type="math/tex">2k-2l</script></span> infected individuals into pairs, who do not shake hands with healthy individuals</li>
<li><span class="math inline-math"><script type="math/tex">R_{n-2k-2l}</script></span> is the number of ways to arrange <span class="math inline-math"><script type="math/tex">n-2k-2l</script></span> healthy individuals into pairs, who do not shake hands with infected individuals and keep being healthy</li>
<li><span class="math inline-math"><script type="math/tex">R_n</script></span> is the total number of ways to arrange <span class="math inline-math"><script type="math/tex">n</script></span> people into <span class="math inline-math"><script type="math/tex">n/2</script></span> pairs in the room</li>
</ul>
<p>Simplification gives</p>
<span class="math display-math"><script type="math/tex; mode=display">p_{2k, 2(k+l)} =\frac{C_{n/2}^{k+l}C_{k+l}^{2l}4^l}{C_n^{2k}}
</script></span>
<p>Then the distribution of <span class="math inline-math"><script type="math/tex">I_{10}</script></span> is</p>
<span class="math display-math"><script type="math/tex; mode=display">\boldsymbol{p}_{I_{10}}^\top=\boldsymbol{e}_1^\top P^{10}
</script></span>
<p>where <span class="math inline-math"><script type="math/tex">\boldsymbol{e}_1 = [1,0,\ldots,0]</script></span> and <span class="math inline-math"><script type="math/tex">\boldsymbol{p}_{I_{10}} = [p_{1,1}^{(10)}, \ldots, p_{1,n}^{(10)}]</script></span></p>
<p>The expected number is</p>
<span class="math display-math"><script type="math/tex; mode=display">\mathrm{E}(I_{10}) = [1,2,3,\ldots, n]^\top\boldsymbol{p}_{I_{10}} 
</script></span>
<p>A python script to implement the above steps:</p>
<pre class="editor-colors lang-python" style="tab-size: 2;"><span class="syntax--source syntax--python"><span class="syntax--keyword syntax--control">import</span> numpy <span class="syntax--keyword syntax--control">as</span> np
<span class="syntax--keyword syntax--control">import</span> scipy.sparse <span class="syntax--keyword syntax--control">as</span> sparse
<span class="syntax--keyword syntax--control">from</span> scipy.special <span class="syntax--keyword syntax--control">import</span> comb, perm, factorial

n <span class="syntax--keyword syntax--operator">=</span> <span class="syntax--constant syntax--numeric">1000</span>
t <span class="syntax--keyword syntax--operator">=</span> <span class="syntax--constant syntax--numeric">5</span>
ks <span class="syntax--keyword syntax--operator">=</span> <span class="syntax--support syntax--function">list</span>(<span class="syntax--support syntax--function">range</span>(<span class="syntax--constant syntax--numeric">1</span>, <span class="syntax--constant syntax--numeric">500</span><span class="syntax--keyword syntax--operator">+</span><span class="syntax--constant syntax--numeric">1</span>))
rows <span class="syntax--keyword syntax--operator">=</span> [<span class="syntax--constant syntax--numeric">0</span>, <span class="syntax--constant syntax--numeric">1</span>]
cols <span class="syntax--keyword syntax--operator">=</span> [<span class="syntax--constant syntax--numeric">0</span>, <span class="syntax--constant syntax--numeric">2</span>]
ps <span class="syntax--keyword syntax--operator">=</span> [<span class="syntax--constant syntax--numeric">0</span>, <span class="syntax--constant syntax--numeric">1</span>]
<span class="syntax--keyword syntax--control">for</span> k <span class="syntax--keyword syntax--operator syntax--logical syntax--python">in</span> ks:
    <span class="syntax--keyword syntax--control">for</span> l <span class="syntax--keyword syntax--operator syntax--logical syntax--python">in</span> <span class="syntax--support syntax--function">range</span>(<span class="syntax--constant syntax--numeric">0</span>, <span class="syntax--support syntax--function">int</span>(<span class="syntax--support syntax--function">min</span>(k, n<span class="syntax--keyword syntax--operator">/</span><span class="syntax--constant syntax--numeric">2</span><span class="syntax--keyword syntax--operator">-</span>k))<span class="syntax--keyword syntax--operator">+</span><span class="syntax--constant syntax--numeric">1</span>):
        rows.<span class="syntax--entity syntax--name syntax--function">append</span>(<span class="syntax--constant syntax--numeric">2</span> <span class="syntax--keyword syntax--operator">*</span> k)
        cols.<span class="syntax--entity syntax--name syntax--function">append</span>(<span class="syntax--constant syntax--numeric">2</span> <span class="syntax--keyword syntax--operator">*</span> (k<span class="syntax--keyword syntax--operator">+</span>l))
        ps.<span class="syntax--entity syntax--name syntax--function">append</span>(<span class="syntax--entity syntax--name syntax--function">comb</span>(n<span class="syntax--keyword syntax--operator">/</span><span class="syntax--constant syntax--numeric">2</span>, k<span class="syntax--keyword syntax--operator">+</span>l) <span class="syntax--keyword syntax--operator">*</span> <span class="syntax--entity syntax--name syntax--function">comb</span>(k<span class="syntax--keyword syntax--operator">+</span>l, <span class="syntax--constant syntax--numeric">2</span><span class="syntax--keyword syntax--operator">*</span>l) <span class="syntax--keyword syntax--operator">*</span> <span class="syntax--constant syntax--numeric">4</span><span class="syntax--keyword syntax--operator">**</span>l <span class="syntax--keyword syntax--operator">/</span> <span class="syntax--entity syntax--name syntax--function">comb</span>(n, <span class="syntax--constant syntax--numeric">2</span><span class="syntax--keyword syntax--operator">*</span>k))

P <span class="syntax--keyword syntax--operator">=</span> sparse.<span class="syntax--entity syntax--name syntax--function">coo_matrix</span>((ps, (rows,cols)), <span class="syntax--variable syntax--parameter syntax--function">shape</span><span class="syntax--keyword syntax--operator">=</span>(n<span class="syntax--keyword syntax--operator">+</span><span class="syntax--constant syntax--numeric">1</span>, n<span class="syntax--keyword syntax--operator">+</span><span class="syntax--constant syntax--numeric">1</span>))
Pt <span class="syntax--keyword syntax--operator">=</span> P<span class="syntax--keyword syntax--operator">**</span>t
distribution <span class="syntax--keyword syntax--operator">=</span> Pt[<span class="syntax--constant syntax--numeric">1</span>, :]
Et <span class="syntax--keyword syntax--operator">=</span> <span class="syntax--support syntax--function">sum</span>([i <span class="syntax--keyword syntax--operator">*</span> distribution.<span class="syntax--entity syntax--name syntax--function">toarray</span>()[<span class="syntax--constant syntax--numeric">0</span>, i] <span class="syntax--keyword syntax--control">for</span> i <span class="syntax--keyword syntax--operator syntax--logical syntax--python">in</span> <span class="syntax--support syntax--function">range</span>(<span class="syntax--constant syntax--numeric">1</span>, n<span class="syntax--keyword syntax--operator">+</span><span class="syntax--constant syntax--numeric">1</span>)])
<span class="syntax--support syntax--function">print</span>(Et) <span class="syntax--comment syntax--line"># 642.347</span></span></pre>
<h2 id="solution-2%3A-conditional-expectation">Solution 2: Conditional Expectation</h2>
<p>For each infected individual,</p>
<span class="math display-math"><script type="math/tex; mode=display">\begin{align}
p_t :&= \operatorname{P}(\text{an infected individual is paried with any healthy individuals at time $t$}) \\
& = \frac{n-I_t} {n - 1} \\
\mathrm{E}(I_{t+1}|I_t) & = I_t + I_t \times p_t \\
& = I_t + I_t \times \frac{n-I_t}{n - 1} \\
\end{align}</script></span>
<p>How to solve it?</p>
<p>By the law of total expectation,</p>
<span class="math display-math"><script type="math/tex; mode=display">\begin{align}
\mathrm{E}(I_{t+1}) & = E\left[\mathrm{E}(I_{t+1}|I_t)\right] \\
& = E\left(I_t + I_t \times \frac{n-I_t}{n - 1} \right)\\
& = \frac{2n-1}{n-1}\mathrm{E}\left( I_t \right) - \frac{1}{n-1}\mathrm{E}\left( I_t^2 \right)
\end{align}</script></span>
<p>In particular, since <span class="math inline-math"><script type="math/tex">\mathrm{P}(I_1=2\vert I_0=1)=1</script></span>, there is no randomness in <span class="math inline-math"><script type="math/tex">I_1</script></span>, such that</p>
<span class="math display-math"><script type="math/tex; mode=display">\begin{align}

\mathrm{E}(I_2) &= E\left[\mathrm{E}(I_2\vert I_1)\right] \\
&= E\left(I_1 + I_1 \times \frac{n-I_1}{n - 1}\right)\\
& = 2 + 2 \times 998 / 999 \\
& = 3994/999
\end{align}</script></span>
<p>But when <span class="math inline-math"><script type="math/tex">t\ge 3</script></span>, the recurrence relation become complicated due to the second-order term <span class="math inline-math"><script type="math/tex">\mathrm{E}\left( I_t^2 \right)</script></span></p>
<p>An attempt is to find a range that does not involve the second-order term,</p>
<span class="math display-math"><script type="math/tex; mode=display">? \le I_t + I_t \times \frac{n-I_t}{n - 1} \le 2I_t
</script></span>
<h2 id="solution-3%3A-simulation">Solution 3: Simulation</h2>
<p>To verify the solutions above, we can simulate the infection process.</p>
<pre class="editor-colors lang-python" style="tab-size: 2;"><span class="syntax--source syntax--python"><span class="syntax--keyword syntax--control">import</span> numpy <span class="syntax--keyword syntax--control">as</span> np

<span class="syntax--storage syntax--type syntax--class">class</span> <span class="syntax--entity syntax--name syntax--type syntax--class">Population</span>():
    <span class="syntax--storage syntax--type syntax--function">def</span> <span class="syntax--entity syntax--name syntax--function">__init__</span>(<span class="syntax--variable syntax--parameter syntax--function">self</span>, <span class="syntax--variable syntax--parameter syntax--function">n</span>):
        self.<span class="syntax--variable syntax--other syntax--object syntax--property">size</span> <span class="syntax--keyword syntax--operator">=</span> n
        self.<span class="syntax--variable syntax--other syntax--object syntax--property">infected</span> <span class="syntax--keyword syntax--operator">=</span> np.<span class="syntax--entity syntax--name syntax--function">array</span>([<span class="syntax--constant syntax--numeric">0</span>]) <span class="syntax--comment syntax--line"># indexes of infected individuals</span>

    <span class="syntax--storage syntax--type syntax--function">def</span> <span class="syntax--entity syntax--name syntax--function">infect</span>(<span class="syntax--variable syntax--parameter syntax--function">self</span>, <span class="syntax--variable syntax--parameter syntax--function">t</span><span class="syntax--keyword syntax--operator">=</span><span class="syntax--constant syntax--numeric">1</span>):
        <span class="syntax--string syntax--quoted">"""
        simulate infection for t minutes
        """</span>
        <span class="syntax--keyword syntax--control">for</span> _ <span class="syntax--keyword syntax--operator syntax--logical syntax--python">in</span> <span class="syntax--support syntax--function">range</span>(t):
            perm <span class="syntax--keyword syntax--operator">=</span> np.<span class="syntax--variable syntax--other syntax--object syntax--property">random</span>.<span class="syntax--entity syntax--name syntax--function">permutation</span>(self.<span class="syntax--variable syntax--other syntax--object syntax--property">size</span>) <span class="syntax--comment syntax--line"># permutation of indexes</span>
            perm_pairs <span class="syntax--keyword syntax--operator">=</span> perm.<span class="syntax--entity syntax--name syntax--function">reshape</span>(n<span class="syntax--keyword syntax--operator">//</span><span class="syntax--constant syntax--numeric">2</span>, <span class="syntax--constant syntax--numeric">2</span>)
            status <span class="syntax--keyword syntax--operator">=</span> np.<span class="syntax--entity syntax--name syntax--function">isin</span>(perm, self.<span class="syntax--variable syntax--other syntax--object syntax--property">infected</span>, <span class="syntax--variable syntax--parameter syntax--function">assume_unique</span><span class="syntax--keyword syntax--operator">=</span><span class="syntax--constant syntax--language">True</span>)
            status_pairs <span class="syntax--keyword syntax--operator">=</span> status.<span class="syntax--entity syntax--name syntax--function">reshape</span>(self.<span class="syntax--variable syntax--other syntax--object syntax--property">size</span><span class="syntax--keyword syntax--operator">//</span><span class="syntax--constant syntax--numeric">2</span>, <span class="syntax--constant syntax--numeric">2</span>)
            new_pairs <span class="syntax--keyword syntax--operator">=</span> np.<span class="syntax--entity syntax--name syntax--function">logical_xor</span>(status_pairs[:,<span class="syntax--constant syntax--numeric">0</span>], status_pairs[:,<span class="syntax--constant syntax--numeric">1</span>])
            new_boolean <span class="syntax--keyword syntax--operator">=</span> <span class="syntax--keyword syntax--operator">~</span>status_pairs[new_pairs]
            new_individuals <span class="syntax--keyword syntax--operator">=</span> perm_pairs[new_pairs][new_boolean].<span class="syntax--entity syntax--name syntax--function">flatten</span>()
            self.<span class="syntax--variable syntax--other syntax--object syntax--property">infected</span> <span class="syntax--keyword syntax--operator">=</span> np.<span class="syntax--entity syntax--name syntax--function">hstack</span>((self.<span class="syntax--variable syntax--other syntax--object syntax--property">infected</span>, new_individuals))

    <span class="syntax--storage syntax--type syntax--function">def</span> <span class="syntax--entity syntax--name syntax--function">count_infected</span>(<span class="syntax--variable syntax--parameter syntax--function">self</span>):
        <span class="syntax--keyword syntax--control">return</span> <span class="syntax--support syntax--function">len</span>(self.<span class="syntax--variable syntax--other syntax--object syntax--property">infected</span>)


n <span class="syntax--keyword syntax--operator">=</span> <span class="syntax--constant syntax--numeric">1000</span>
t <span class="syntax--keyword syntax--operator">=</span> <span class="syntax--constant syntax--numeric">10</span>
pop <span class="syntax--keyword syntax--operator">=</span> <span class="syntax--entity syntax--name syntax--function">Population</span>(n)
pop.<span class="syntax--entity syntax--name syntax--function">infect</span>(<span class="syntax--variable syntax--parameter syntax--function">t</span><span class="syntax--keyword syntax--operator">=</span><span class="syntax--constant syntax--numeric">10</span>)
<span class="syntax--support syntax--function">print</span>(pop.<span class="syntax--entity syntax--name syntax--function">count_infected</span>())</span></pre>
<p>To get the expected number <span class="math inline-math"><script type="math/tex">E(I_{10})</script></span>, we can try to simulate <span class="math inline-math"><script type="math/tex">m</script></span> times and take the average.</p>
<pre class="editor-colors lang-python" style="tab-size: 2;"><span class="syntax--source syntax--python">It <span class="syntax--keyword syntax--operator">=</span> []
m <span class="syntax--keyword syntax--operator">=</span> <span class="syntax--constant syntax--numeric">10000</span>
t <span class="syntax--keyword syntax--operator">=</span> <span class="syntax--constant syntax--numeric">10</span>
<span class="syntax--keyword syntax--control">for</span> _ <span class="syntax--keyword syntax--operator syntax--logical syntax--python">in</span> <span class="syntax--support syntax--function">range</span>(m):
    pop <span class="syntax--keyword syntax--operator">=</span> <span class="syntax--entity syntax--name syntax--function">Population</span>(n)
    pop.<span class="syntax--entity syntax--name syntax--function">infect</span>(t)
    It.<span class="syntax--entity syntax--name syntax--function">append</span>(pop.<span class="syntax--entity syntax--name syntax--function">count_infected</span>())
<span class="syntax--support syntax--function">print</span>(<span class="syntax--support syntax--function">sum</span>(It)<span class="syntax--keyword syntax--operator">/</span>m) <span class="syntax--comment syntax--line"># 642.21</span></span></pre>
<p>We see the simulation result <span class="math inline-math"><script type="math/tex">642.21</script></span> is quite close to the result <span class="math inline-math"><script type="math/tex">E(I_{10}) = 642.347</script></span> in Solution 1.</p>

  </body>
</html>
